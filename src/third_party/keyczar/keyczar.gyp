# Copyright (c) 2013, Google Inc. All rights reserved.
# 
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#     http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.

{
  'target_defaults': {
    'cflags': [
      '-O2',
    ],
    'product_dir': 'bin',
  },
  'variables': {
    'src': 'cpp/src/keyczar',
    'base': '<(src)/base',
    'openssl': '<(src)/openssl',
    'rw': '<(src)/rw',
  },
  'targets': [
    {
      'target_name': 'keyczar_openssl',
      'type': 'static_library',
      'sources': [
	'<(openssl)/aes.cc',
	'<(openssl)/aes.h',
	'<(openssl)/dsa.cc',
	'<(openssl)/dsa.h',
	'<(openssl)/ecdsa.cc',
	'<(openssl)/ecdsa.h',
	'<(openssl)/hmac.cc',
	'<(openssl)/hmac.h',
	'<(openssl)/message_digest.cc',
	'<(openssl)/message_digest.h',
	'<(openssl)/pbe.cc',
	'<(openssl)/pbe.h',
	'<(openssl)/rand.cc',
	'<(openssl)/rand.h',
	'<(openssl)/rsa.cc',
	'<(openssl)/rsa.h',
	'<(openssl)/util.cc',
	'<(openssl)/util.h',
      ],
      'include_dirs': [
        'cpp/src',
      ],
      'direct_dependent_settings': {
        'libraries': [
	  '-lcrypto',
	],
        'include_dirs': [
          'cpp/src',
        ],
      },
    },
    {
      'target_name': 'keyczar',
      'type': 'static_library',
      'sources': [
        '<(src)/aes_impl.h',
	'<(src)/aes_key.cc',
	'<(src)/aes_key.h',
	'<(src)/cipher_mode.cc',
	'<(src)/cipher_mode.h',
	'<(src)/crypto_factory.cc',
	'<(src)/crypto_factory.h',
	'<(src)/dsa_impl.h',
	'<(src)/dsa_private_key.cc',
	'<(src)/dsa_private_key.h',
	'<(src)/dsa_public_key.cc',
	'<(src)/dsa_public_key.h',
	'<(src)/ecdsa_impl.cc',
	'<(src)/ecdsa_impl.h',
	'<(src)/ecdsa_private_key.cc',
	'<(src)/ecdsa_private_key.h',
	'<(src)/ecdsa_public_key.cc',
	'<(src)/ecdsa_public_key.h',
	'<(src)/hmac_impl.cc',
	'<(src)/hmac_impl.h',
	'<(src)/hmac_key.cc',
	'<(src)/hmac_key.h',
	'<(src)/key.cc',
	'<(src)/keyczar.cc',
	'<(src)/keyczar.h',
	'<(src)/key.h',
	'<(src)/key_purpose.cc',
	'<(src)/key_purpose.h',
	'<(src)/keyset.cc',
	'<(src)/keyset.h',
	'<(src)/keyset_metadata.cc',
	'<(src)/keyset_metadata.h',
	'<(src)/key_status.cc',
	'<(src)/key_status.h',
	'<(src)/key_type.cc',
	'<(src)/key_type.h',
	'<(src)/key_util.cc',
	'<(src)/key_util.h',
	'<(src)/message_digest_impl.cc',
	'<(src)/message_digest_impl.h',
	'<(src)/pbe_impl.cc',
	'<(src)/pbe_impl.h',
	'<(src)/private_key.cc',
	'<(src)/private_key.h',
	'<(src)/public_key.cc',
	'<(src)/public_key.h',
	'<(src)/rand_impl.h',
	'<(src)/rsa_impl.h',
	'<(src)/rsa_private_key.cc',
	'<(src)/rsa_private_key.h',
	'<(src)/rsa_public_key.cc',
	'<(src)/rsa_public_key.h',
	'<(src)/secret_key.cc',
	'<(src)/secret_key.h',
	'<(src)/session.cc',
	'<(src)/session.h',
	'<(src)/util.cc',
	'<(src)/util.h',
	'<(base)/base64w.cc',
	'<(base)/base64w.h',
	'<(base)/basictypes.h',
	'<(base)/build_config.h',
	'<(base)/command_line.cc',
	'<(base)/command_line.h',
	'<(base)/compiler_specific.h',
	'<(base)/file_path.cc',
	'<(base)/file_path.h',
	'<(base)/file_util.cc',
	'<(base)/file_util.h',
	'<(base)/file_util_posix.cc',
	'<(base)/json_reader.cc',
	'<(base)/json_reader.h',
	'<(base)/json_value_serializer.cc',
	'<(base)/json_value_serializer.h',
	'<(base)/json_writer.cc',
	'<(base)/json_writer.h',
	'<(base)/logging.cc',
	'<(base)/logging.h',
	'<(base)/observer_list.h',
	'<(base)/port.h',
	'<(base)/ref_counted.cc',
	'<(base)/ref_counted.h',
	'<(base)/scoped_handle.h',
	'<(base)/scoped_handle_win.h',
	'<(base)/scoped_ptr.h',
	'<(base)/stl_util-inl.cc',
	'<(base)/stl_util-inl.h',
	'<(base)/string_escape.cc',
	'<(base)/string_escape.h',
	'<(base)/string_util.cc',
	'<(base)/string_util.h',
	'<(base)/string_util_posix.h',
	'<(base)/string_util_win.h',
	'<(base)/values.cc',
	'<(base)/values.h',
	'<(base)/zlib.cc',
	'<(base)/zlib.h',
	'<(rw)/keyset_encrypted_file_reader.cc',
	'<(rw)/keyset_encrypted_file_reader.h',
	'<(rw)/keyset_encrypted_file_writer.cc',
	'<(rw)/keyset_encrypted_file_writer.h',
	'<(rw)/keyset_file_reader.cc',
	'<(rw)/keyset_file_reader.h',
	'<(rw)/keyset_file_writer.cc',
	'<(rw)/keyset_file_writer.h',
	'<(rw)/keyset_reader.cc',
	'<(rw)/keyset_reader.h',
	'<(rw)/keyset_writer.cc',
	'<(rw)/keyset_writer.h',
      ],
      'dependencies': [
        'keyczar_openssl',
      ],
      'include_dirs': [
        'cpp/src',
      ],
      'direct_dependent_settings': {
	'dependencies': [
	  'keyczar_openssl',
        ],
        'include_dirs': [
	  'cpp/src',
        ],
      },
    },
  ]
}
