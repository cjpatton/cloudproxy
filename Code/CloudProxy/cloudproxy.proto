package cloudproxy;

enum Op {
    ALL = 0;
    AUTH = 1;
    CREATE = 2;
    DESTROY = 3;
    WRITE = 4;
    READ = 5;
}

message Action {
    required string subject = 1;
    required Op verb = 2;
    optional string object = 3;
}

message ACL {
    repeated Action permissions = 1;
}

message Challenge {
    required string nonce = 1;
}

message Response {
    required string nonce = 1;
    required string signature = 2;
}

message ClientMessage {
    optional Action action = 1;
    optional Response response = 2;
}

message ServerMessage {
    optional Challenge challenge = 1;
}

