package cloudproxy;

enum Op {
    ALL = 0;
    AUTH = 1;
    CREATE = 2;
    DESTROY = 3;
    WRITE = 4;
    READ = 5;
}

message Action {
    required string subject = 1;
    required Op verb = 2;
    optional string object = 3;
}

message ACL {
    repeated Action permissions = 1;
}

message SignedACL {
    required ACL acls = 1;
    required string signature = 2;
}

message Challenge {
    required string subject = 1;
    required string nonce = 2;
}

message Response {
    required string serialized_chall = 1;
    required string signature = 2;
}

message ClientMessage {
    optional Action action = 1;
    optional Response response = 2;
}

message ServerMessage {
    optional Challenge challenge = 1;
}

// a message that gives a name to a given keyczar public key structure
message SpeaksFor {
    required string subject = 1;
    required string pub_key = 2;
    required string meta = 3;
}

message SignedSpeaksFor {
    required string serialized_speaks_for = 1;
    required string signature = 2;
}
