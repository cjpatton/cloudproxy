Instructions for testing fileProxy on KVM
=========================================



1. stop tcsd if started

  /etc/init.d/trousers stop 

2. make sure you have access to the tpm device. 

  chown <username> /dev/tpm0

you will have to log out and back in to get the right group permissions.

3. add tcioDD to the kernel  
  cd ~/jlmcrypt
  insmod kvmtciodd.ko
  chmod 0777 /dev/kvmtciod

The first time you run tcService, you must run it with the -initKeys flag.  
This generates the OS keys stores them and causes keyNegoServer to sign them.  
In the paper, this is called "tao initialization" for the OS.  keyNegoServer 
need only be available when a tao layer needs to initialize.  Here
is a procedure.  Start keyNegoServer.  In a different console on the 
fileProxy machine, type:

./tcKvmService.exe -initKeys

Unlike a normal run of tcService where tcService continues running, 
tcService will exit after the keys are generated and the cert signed 
and stored.  

The procedure is similar to the Linux tests after that.  The KVM must
also have custom CloudProxy patches installed to intercept service calls
from ktciodd to the KVM.

A KVM guest partition must have a statically linked ktciodd device
driver and be running a tcKvmGuestOsService.exe services.  
Initialization of all the tcservices is analogous.

